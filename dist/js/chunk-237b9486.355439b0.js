(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-237b9486"],{"090c":function(t,e,r){"use strict";r.d(e,"a",(function(){return v}));var o=r("3bda"),i=r("2b0e");function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){return l(t)||m(t)||d(t)||h()}function l(t){if(Array.isArray(t))return u(t)}function m(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function d(t,e){if(t){if("string"===typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(t){return i[t]}var g=p("h"),f=function(t,e,r){return Object(o["a"])(s(s({},e),{},{preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",title:t},r))},b=function(t,e,r,o){var i={attrs:f(t,e,r.attrs),on:o,style:s(s({},r.staticStyle),r.style)};return delete i.attrs.style,(r.staticClass||r.class)&&(i.class={},r.staticClass&&(i.class[r.staticClass]=!0),r.class&&(i.class[r.class]=!0)),i},v=function(t,e,r){return s({props:{title:String},name:t},g?{setup:function(t,o){var i=t.title,a=o.attrs,s=o.slots;return function(){return g("svg",f(i,e,a),[].concat(c(i?[g("title",i)]:[]),c(r.map((function(t){var e=t.elem,r=t.attrs;return g(e,r)}))),c(s.default?s.default():[])))}}}:{functional:!0,render:function(t,o){var i=o.props.title,a=o.children,s=o.data,n=o.listeners;return t("svg",b(i,e,s,n),[].concat(c(i?[t("title",null,i)]:[]),c(r.map((function(e){var r=e.elem,o=e.attrs;return t(r,{attrs:o})}))),c(a||[])))}})}},2205:function(t,e,r){"use strict";r("851d")},"222a":function(t,e,r){"use strict";var o=r("090c"),i=Object(o["a"])(i,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},[{elem:"path",attrs:{d:"M17.74,30,16,29l4-7h6a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2H6A2,2,0,0,0,4,8V20a2,2,0,0,0,2,2h9v2H6a4,4,0,0,1-4-4V8A4,4,0,0,1,6,4H26a4,4,0,0,1,4,4V20a4,4,0,0,1-4,4H21.16Z"}},{elem:"path",attrs:{d:"M8 10H24V12H8zM8 16H18V18H8z"}}]);e["a"]=i},"3bda":function(t,e,r){"use strict";function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){if(null==t)return{};var r,o,i={},a=Object.keys(t);for(o=0;o<a.length;o++)r=a[o],e.indexOf(r)>=0||(i[r]=t[r]);return i}function n(t,e){if(null==t)return{};var r,o,i=s(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)r=a[o],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}r.d(e,"a",(function(){return d}));var c=["width","height","viewBox"],l=["tabindex"],m={focusable:"false",preserveAspectRatio:"xMidYMid meet"};function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,r=t.height,o=t.viewBox,a=void 0===o?"0 0 ".concat(e," ").concat(r):o,s=n(t,c),d=s.tabindex,u=n(s,l),h=i(i(i({},m),u),{},{width:e,height:r,viewBox:a});return h["aria-label"]||h["aria-labelledby"]||h.title?(h.role="img",void 0!==d&&null!==d&&(h.focusable="true",h.tabindex=d)):h["aria-hidden"]=!0,h}},"851d":function(t,e,r){},b556:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"bx--grid"},[r("div",{staticClass:"bx--row"},[r("div",{staticClass:"bx--col-lg-2"},[r("cv-accordion",{ref:"acc"},[r("cv-accordion-item",{attrs:{open:!0}},[r("template",{slot:"title"},[t._v("Conversas: ")]),r("template",{slot:"content"},t._l(t.historicoComputed,(function(e){return r("div",{key:e.chatCom,staticClass:"bx--row",staticStyle:{height:"3.6rem"}},[r("div",{staticClass:"bx--col--lg"},[r("img",{staticStyle:{width:"2rem",height:"2rem","border-radius":"50%",cursor:"pointer"},attrs:{src:"static/"+e.chatcom+".png"},on:{click:function(r){return t.createRoom(e.chatcom)}}})]),r("div",{staticClass:"bx--col--lg",staticStyle:{"padding-top":"0.3rem","padding-left":"0.5rem"}},[r("div",{staticClass:"bx--row"},[e.chatcom!==t.modalEdit?r("p",{staticStyle:{"padding-left":"1rem",cursor:"pointer"},attrs:{id:e.chatcom},on:{click:function(r){return t.createRoom(e.chatcom)}}},[t._v(" "+t._s(e.chatcom)+" ")]):t._e()]),r("div",{staticClass:"bx--row"},[e.chatcom!==t.modalEdit?r("p",{staticStyle:{"padding-left":"1rem",cursor:"pointer","font-size":"10px"},attrs:{id:e.chatcom},on:{click:function(r){return t.createRoom(e.chatcom)}}},[t._v(" "+t._s(e.ultimaMensagem.substr(0,17))+" ... ")]):t._e()])]),-1!==t.listNotificationMensagem.indexOf(e.chatcom)?r("div",{staticClass:"bx--col--lg",staticStyle:{"padding-top":"0.3rem","padding-left":"0.5rem"}},[r("ChatIco")],1):t._e()])})),0)],2)],1)],1),r("div",{staticClass:"bx--col"},[" "!==t.chatAberto?r("div",{staticClass:"bx--row"},[r("div",{staticClass:"bx--col",staticStyle:{border:"1px solid"}},[r("div",{staticClass:"bx--row"},[r("div",{staticStyle:{width:"80%","padding-top":"0.5rem","padding-bottom":"0.5rem"},attrs:{lass:"bx--col--lg"}},[t._v(" ID CHAT : "+t._s(t.listRoomComputed.room)+" "+t._s(t.chatAberto)+" ")])]),r("div",{staticClass:"bx--row",staticStyle:{overflow:"auto","flex-direction":"column-reverse",height:"76vh"}},[r("div",{staticClass:"bx--col"},t._l(t.messages,(function(e,o){return r("div",{key:o,staticClass:"bx--row"},[e.from!==t.modalEdit?r("div",{staticClass:"bx--col--lg",staticStyle:{"padding-left":"0.5rem"}},[r("img",{staticStyle:{width:"2rem",height:"2rem","border-radius":"50%","margin-top":"1rem"},attrs:{src:"static/"+e.from+".png"}})]):t._e(),e.from!==t.modalEdit?r("div",{staticClass:"bx--col--lg",staticStyle:{"background-color":"white","min-height":"1rem","margin-left":"0.5rem","margin-top":"0.5rem","padding-top":"0.5rem","padding-bottom":"0.5rem","border-radius":"25px",padding:"1rem"}},[r("span",{staticClass:"message"},[t._v(" "+t._s(e.message)+" ")])]):t._e(),e.from===t.modalEdit?r("messageLeft",{attrs:{message:e}}):t._e()],1)})),0)]),r("div",{staticClass:"bx--row",staticStyle:{"padding-top":"1rem"}},[r("div",{staticClass:"chat-window",staticStyle:{width:"100%"},attrs:{id:t.listRoomComputed.room}},[r("div",{staticClass:"body"}),r("div",{staticClass:"footer"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.mensagemParticular,expression:"mensagemParticular"}],staticClass:"messageText",staticStyle:{width:"90%",height:"2.5rem"},attrs:{type:"text"},domProps:{value:t.mensagemParticular},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage(t.listRoomComputed.room,t.listRoomComputed.withUserId)},input:function(e){e.target.composing||(t.mensagemParticular=e.target.value)}}}),r("button",{staticStyle:{height:"2.5rem",width:"10%"},on:{click:function(e){return t.sendMessage(t.listRoomComputed.room,t.listRoomComputed.withUserId)}}},[t._v(" GO ")])])])])])]):t._e()])])])},i=[],a=r("2f62"),s=r("bc3a"),n=r.n(s),c=r("222a");const l=()=>r.e("chunk-3ab4efaf").then(r.bind(null,"6ee8")),m=io({transports:["websocket"]});console.log("criar socket.io");var d={name:"chat",data(){return{messages:[],mensagemParticular:[],listRoom:[],reconectar:"",historico:[],chatAberto:"",listNotificationMensagem:[],token:""}},components:{ChatIco:c["a"],messageLeft:l},computed:{...Object(a["c"])(["modalEdit","chamarChat"]),listRoomComputed:{get(){return this.listRoom}},historicoComputed:{get(){return this.historico}}},methods:{...Object(a["b"])(["setLoadingPage","setModalEdit"]),async createRoom(t){if(console.log("ETAPA 3"),this.chatAberto!==t||this.reconectar===this.chatAberto){this.chatAberto=t,this.reconectar=!1;let e=this.modalEdit,r="";r=this.modalEdit>t?this.modalEdit+t:t+this.modalEdit,this.listRoom={room:r,withUserId:t},this.mensagemParticular="";let o={token:this.token,room:r},i=await n.a.post("/api/mensagens",o);i.data.length>0&&(this.messages=i.data),m.emit("create",{room:r,userId:e.userId,withUserId:t,user:this.modalEdit})}},sendMessage(t,e){if(console.log("Enviar mensagem "),""===this.mensagemParticular)return"";let r=this.modalEdit,o=this.mensagemParticular;this.mensagemParticular="",m.emit("message",{room:t,message:o,from:r,withUserId:e}),this.messages.push({room:t,message:o,from:r})},async mensagemAntiga(){console.log("ETAPA 4");let t={token:this.token,usuario:this.modalEdit},e=await n.a.post("/api/historico/mensagens",t);!0===e.data.status&&(this.createRoom(e.data.data[0].chatcom),this.historico=e.data.data)},async checarToken(){if(console.log("ETAPA 1"),null!==this.token){let t=await n.a.post("/api/token/user",{token:this.token});!0===t.data.status&&(await this.setModalEdit(t.data.usuario),await this.criarUsuario(),await this.mensagemAntiga())}else this.$router.push("/login")},criarUsuario(){console.log("ETAPA 2"),m.emit("loggedin",{user_id:this.modalEdit})," "!==this.chamarChat&&this.createRoom(this.chamarChat)}},mounted(){this.token=this.$cookies.get("token"),this.checarToken()},created:function(){m.on("updateUserList",t=>{!1!==this.reconectar&&-1!==t[1].indexOf(this.reconectar)&&this.createRoom(this.listRoomComputed.withUserId),-1===t[1].indexOf(this.listRoomComputed.withUserId)&&this.reconectar!==this.listRoomComputed.withUserId&&(this.reconectar=this.listRoomComputed.withUserId,this.messages.push({room:this.listRoomComputed.room,message:"Usuario esta Off-line",from:"off"})),this.setLoadingPage("")}),m.on("invite",t=>{m.emit("joinRoom",t)}),m.on("message",async t=>{this.listRoomComputed.room===t.room?this.messages.push({room:t.room,message:t.message,from:t.from}):this.listNotificationMensagem.push(t.from)})}},u=d,h=(r("2205"),r("2877")),p=Object(h["a"])(u,o,i,!1,null,null,null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-237b9486.355439b0.js.map
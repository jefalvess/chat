(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d6de71f"],{"0edf":function(s,t,e){"use strict";e("61f6")},"61f6":function(s,t,e){},"6e6e":function(s,t,e){"use strict";e.r(t);var o=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"bx--grid"},[e("cv-accordion",{ref:"acc"},[e("cv-accordion-item",[e("template",{slot:"title"},[s._v("Usuarios conectados: "+s._s(s.loadingPage.length-1)+" ")]),e("template",{slot:"content"},[1===s.loadingPage.length?e("div",{staticClass:"bx--row"},[e("p",{staticStyle:{"padding-left":"1rem",cursor:"pointer"}},[s._v("Nenhum usuario conectado ")])]):s._l(s.loadingPage,(function(t){return e("div",{key:t.socketId,staticClass:"bx--row"},[t.user_id!==s.modalEdit?e("p",{staticStyle:{"padding-left":"1rem",cursor:"pointer"},attrs:{id:t.user_id},on:{click:function(e){return s.createRoom(t.user_id)}}},[s._v(" "+s._s(t.user_id)+" ")]):s._e()])}))],2)],2)],1)],1)},i=[],a=e("2f62"),r=e("bc3a"),c=e.n(r);const h=io({transports:["websocket"]});console.log("criar socket.io");var n={name:"chat",data(){return{messages:[],mensagemParticular:[],listRoom:[],chats:[],reconectar:[],toke:""}},computed:{...Object(a["c"])(["loadingPage","modalEdit"]),listRoomComputed:{get(){return this.listRoom}}},methods:{...Object(a["b"])(["setLoadingPage","setChamarChat"]),async createRoom(s){this.setChamarChat(s),this.$router.push("/chat")},minimizeChat(s,t){this.listRoom.splice(t,1),this.chats.splice(t,1),this.messages=this.messages.filter(t=>t.room!==s)},criarUsuario(){""!==this.modalEdit&&h.emit("loggedin",{user_id:this.modalEdit})}},mounted(){this.token=this.$cookies.get("token"),this.criarUsuario()},created:function(){h.on("updateUserList",s=>{console.log("atualia√ßao de usuarios");for(let t=0;t<this.reconectar.length;t++)if(1===s[1].indexOf(this.reconectar[t])){console.log("preciso reconectar esse chat");let s="";s=this.modalEdit>this.chats[t]?this.modalEdit+this.chats[t]:this.chats[t]+this.modalEdit;let e=this.chats.indexOf(this.reconectar[t]);this.minimizeChat(s,e),this.createRoom(this.reconectar[t])}for(let t=0;t<this.chats.length;t++)if(-1===s[1].indexOf(this.chats[t])){let s="";s=this.modalEdit>this.chats[t]?this.modalEdit+this.chats[t]:this.chats[t]+this.modalEdit,-1===this.reconectar.indexOf(this.chats[t])&&(this.reconectar.push(this.chats[t]),this.messages.push({room:s,message:"Usuario esta off",from:"Automatica"}))}this.setLoadingPage(s[0])}),h.on("invite",s=>{console.log("chat foi aberto"),h.emit("joinRoom",s)}),h.on("message",async s=>{if(console.log("CHEGOU UMA MENSAGEM "),-1===this.listRoom.indexOf(s.room)){this.listRoom.push(s.room),this.chats.push(s.from);let t={token:this.token,room:s.room},e=await c.a.post("/api/mensagens",t);e.data.length>0&&(this.messages=this.messages.concat(e.data)),this.messages[this.messages.length-1]=delete this.messages[this.messages.length-1]["_id"],this.messages[this.messages.length-1]!=={room:s.room,message:s.message,from:s.from}&&this.messages.push({room:s.room,message:s.message,from:s.from})}else this.mensagemParticular.push(""),this.messages.push({room:s.room,message:s.message,from:s.from})})}},m=n,l=(e("0edf"),e("2877")),d=Object(l["a"])(m,o,i,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-7d6de71f.4bccce91.js.map